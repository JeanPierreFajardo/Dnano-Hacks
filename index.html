<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asocia tu tarjeta</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #12090b;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    .card {
      width: 360px;
      padding: 22px;
      border-radius: 12px;
      background: linear-gradient(180deg, #24171a, #1b1113);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);
      font-size: 16px;
    }
    h1 {
      font-size: 22px;
      color: #f3b0b8;
      text-align: center;
      margin: 0 0 20px;
    }
    .inputbox {
      background: #1e1416;
      padding: 14px;
      border-radius: 8px;
      margin-bottom: 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    input {
      width: 85%;
      padding: 10px;
      margin: 0;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      background-color: #2a1919;
      color: white;
      outline: none;
    }
    .link-button {
      background-color: #7b4b46;
      border-radius: 8px;
      padding: 10px;
      color: #fff;
      cursor: pointer;
      font-weight: bold;
      margin-left: 10px;
    }
    button {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: none;
      font-weight: 600;
      background: linear-gradient(90deg, #b9616d, #9a4b5b);
      color: #fff;
      cursor: pointer;
      font-size: 16px;
    }
    input:focus {
      background-color: #3a2323;
    }
    input::placeholder {
      color: #ccc;
    }
  </style>

  <!-- Google Pay API -->
  <script async src="https://pay.google.com/gp/p/js/pay.js"></script>
</head>
<body>

<div class="card">
  <h1>Asocia tu tarjeta</h1>
  <form id="card-form" autocomplete="off">
    <div class="inputbox">
      <input type="text" name="card-number" id="card-number" placeholder="Número de tarjeta" autocomplete="cc-number" required />
      <button type="button" class="link-button" id="use-link">Usar link</button>
    </div>
    <div class="inputbox">
      <input type="text" name="expiry-date" id="expiry-date" placeholder="MM/AA" autocomplete="cc-exp" required />
    </div>
    <button type="submit">Guardar tarjeta</button>
  </form>
</div>

<script>
// Configuración de Google Pay
const client = new google.payments.api.PaymentsClient({ environment: 'TEST' });

const paymentRequest = {
  apiVersion: 2,
  apiVersionMinor: 0,
  allowedPaymentMethods: [
    {
      type: 'CARD',
      parameters: {
        allowedAuthMethods: ['PAN_ONLY', 'CRYPTOGRAM_3DS'],
        allowedCardNetworks: ['MASTERCARD', 'VISA']
      },
      tokenizationSpecification: {
        type: 'PAYMENT_GATEWAY',
        parameters: {
          gateway: 'example',
          gatewayMerchantId: 'exampleGatewayMerchantId'
        }
      }
    }
  ]
};

const button = client.createButton({
  onClick: () => {
    client.loadPaymentData(paymentRequest)
      .then(function(paymentData) {
        // Aqui procesas el pago
        console.log("Pago completado:", paymentData);
      })
      .catch(function(error) {
        console.error("Error con Google Pay:", error);
      });
  }
});

// Agregar el botón de Google Pay al formulario
document.getElementById('use-link').appendChild(button);

// No hacer nada cuando se envíe el formulario, ya que Google Pay maneja la acción
const form = document.getElementById('card-form');
form.addEventListener('submit', function(e) {
  e.preventDefault();
  // Aquí no necesitamos hacer nada, ya que el popup lo maneja Google Pay
});
</script>

</body>
</html>
